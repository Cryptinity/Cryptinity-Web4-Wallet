<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cryptinity Web4 - Safe Zone</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons (Switched to JSDelivr for better stability) -->
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon: #ccff00;
            --bg-dark: #050505;
            --glass-border: rgba(255, 255, 255, 0.08);
        }

        body {
            background-color: black;
            color: white;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .safe-padding-top { padding-top: env(safe-area-inset-top, 20px); }
        .safe-padding-bottom { padding-bottom: env(safe-area-inset-bottom, 20px); }

        /* --- BACKGROUND --- */
        .login-bg {
            background-color: #000;
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(204, 255, 0, 0.1) 0%, transparent 60%),
                linear-gradient(0deg, rgba(0,0,0,1) 0%, rgba(20,20,20,0) 50%, rgba(0,0,0,1) 100%);
            background-attachment: fixed;
        }

        /* Glass Panels */
        .glass-panel {
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 50px -10px rgba(0, 0, 0, 0.5);
        }

        /* Chart Styles */
        .glass-chart {
            background: linear-gradient(180deg, rgba(20, 20, 20, 0.9) 0%, rgba(5, 5, 5, 0.95) 100%);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: inset 0 0 40px rgba(0,0,0,0.8);
        }

        .chart-line {
            fill: none;
            stroke: var(--neon);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 0 6px rgba(204, 255, 0, 0.3));
        }
        
        .chart-area {
            fill: url(#gradientArea);
            opacity: 0.3;
        }

        /* Logo Container */
        .cty-logo-container {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }
        .cty-logo-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scale(1.1);
        }

        /* Screen Management */
        .screen { 
            display: none; 
            opacity: 0; 
            transition: opacity 0.4s ease; 
            width: 100%; 
            min-height: 100vh;
        }
        .screen.active { display: flex; opacity: 1; flex-direction: column; }
        
        /* Dashboard Layout */
        #dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }

        @media (min-width: 1024px) {
            #dashboard-grid {
                grid-template-columns: 2fr 1fr;
                padding: 2rem;
                height: calc(100vh - 80px);
            }
            .desktop-full-height {
                height: 100%;
                overflow-y: auto;
            }
            #main-chart-container {
                height: 400px;
            }
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Typography */
        .whitepaper-content h1 { color: #ccff00; font-size: 1.5rem; font-weight: 800; margin-bottom: 1rem; margin-top: 2rem; }
        .whitepaper-content h2 { color: white; font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; margin-top: 1.5rem; }
        .whitepaper-content p { color: #9ca3af; margin-bottom: 0.8rem; font-size: 0.9rem; line-height: 1.6; }
        .whitepaper-content strong { color: #fff; }
    </style>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, collection, query, orderBy, runTransaction } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA07f3kuyjbvlHi5nxFFhRKARw9yP0R9GI",
            authDomain: "cryptinity-7967a.firebaseapp.com",
            databaseURL: "https://cryptinity-7967a-default-rtdb.firebaseio.com",
            projectId: "cryptinity-7967a",
            storageBucket: "cryptinity-7967a.firebasestorage.app",
            messagingSenderId: "934037242924",
            appId: "1:934037242924:web:d6dd86f6d6dc7ee64a3d89"
        };

        let app, auth, db, googleProvider;

        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            googleProvider = new GoogleAuthProvider();
        } catch (e) {
            console.error("Firebase Init Error:", e);
        }

        // STATE
        window.appState = {
            user: null,
            balances: {},
            transactions: [],
            currentAsset: 'BTC',
            rates: { USDT: 1, BTC: 65000, ETH: 3500, BNB: 600, SOL: 150, CTY: 0.0004 },
            assets: {
                CTY: { name: 'Cryptinity', id: 'cryptinity', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765028706/9527-removebg-preview_rlecfz.png', symbol: 'CTY' },
                BTC: { name: 'Bitcoin', id: 'bitcoin', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765114062/logaster-2022-08-bitcoin-logo-2010-by-satoshi-nakamoto-min_mqu56d.jpg', symbol: 'BTC' },
                ETH: { name: 'Ethereum', id: 'ethereum', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765114102/ethereum-eth-logo-png_seeklogo-444507_dcjtpk.png', symbol: 'ETH' },
                BNB: { name: 'Binance Coin', id: 'binancecoin', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765114055/binance-logo-6219389_640_o1bvbi.png', symbol: 'BNB' },
                SOL: { name: 'Solana', id: 'solana', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765114056/Solana-Logo-300x300_oa0rqg.png', symbol: 'SOL' },
                USDT: { name: 'Tether', id: 'tether', icon: 'https://res.cloudinary.com/db8haqiqq/image/upload/v1765114068/USDT_Logo_pqvywr.png', symbol: 'USDT' }
            }
        };

        // --- AUTH ---
        window.handleEmailAuth = async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const isSignup = document.getElementById('auth-submit-btn').innerText === 'Sign Up';
            try {
                if(isSignup) await createUserWithEmailAndPassword(auth, email, pass);
                else await signInWithEmailAndPassword(auth, email, pass);
            } catch (err) { alert(err.message); }
        };

        window.handleGoogleAuth = async () => {
            try { await signInWithPopup(auth, googleProvider); } 
            catch (error) { 
                console.error(error);
                alert("Please add cryptinity.github.io to Authorized Domains in Firebase Console."); 
            }
        };

        window.skipAuth = async () => { await signInAnonymously(auth); };

        if (auth) {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    window.appState.user = user;
                    initUserData(user);
                    showScreen('app');
                    fetchLivePrices();
                } else {
                    // Only show auth if not already showing intro
                    if (document.getElementById('intro-screen').style.display === 'none') {
                        showScreen('auth');
                    }
                }
            });
        }

        // --- DATA LAYER ---
        async function fetchLivePrices() {
            try {
                const ids = Object.values(window.appState.assets)
                    .filter(a => a.id !== 'cryptinity')
                    .map(a => a.id).join(',');
                
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd`);
                const data = await response.json();
                
                Object.keys(window.appState.assets).forEach(key => {
                    const id = window.appState.assets[key].id;
                    if (data[id]) window.appState.rates[key] = data[id].usd;
                });
                
                window.appState.rates.CTY = 0.0004; 
                renderAssetList();
                updateBalanceUI();
            } catch (e) { console.warn("Price API:", e); }
        }

        function initUserData(user) {
            try {
                onSnapshot(doc(db, 'artifacts', firebaseConfig.projectId, 'users', user.uid, 'wallet', 'balances'), (doc) => {
                    if (doc.exists()) {
                        window.appState.balances = doc.data();
                        updateBalanceUI();
                        renderAssetList();
                    } else {
                        setDoc(doc.ref, { CTY: 0, BTC: 0, ETH: 0, BNB: 0, SOL: 0, USDT: 0 });
                    }
                });
                const txQ = query(collection(db, 'artifacts', firebaseConfig.projectId, 'users', user.uid, 'transactions'), orderBy('timestamp', 'desc'));
                onSnapshot(txQ, (snap) => {
                    window.appState.transactions = snap.docs.map(d => d.data());
                    renderHistory();
                });
            } catch (e) { console.error("Firestore Error:", e); }
        }

        // --- CHART ---
        window.initChart = async (assetKey) => {
            window.appState.currentAsset = assetKey;
            const asset = window.appState.assets[assetKey];
            
            document.getElementById('chart-icon').src = asset.icon;
            document.getElementById('chart-name').innerText = asset.name;
            document.getElementById('chart-price').innerText = 'Loading...';
            
            if (assetKey === 'CTY' || assetKey === 'USDT') {
                const price = assetKey === 'CTY' ? 0.0004 : 1.00;
                updateChartHeader(price);
                const fakeData = Array(24).fill(0).map((_, i) => price + (Math.random() * price * 0.02));
                drawChart(fakeData);
                return;
            }

            try {
                if (window.appState.rates[assetKey]) updateChartHeader(window.appState.rates[assetKey]);
                
                const response = await fetch(`https://api.coingecko.com/api/v3/coins/${asset.id}/market_chart?vs_currency=usd&days=1`);
                if(!response.ok) throw new Error("API Limit");
                const json = await response.json();
                
                const prices = json.prices.map(p => p[1]);
                const downsampled = prices.filter((_, i) => i % 5 === 0).slice(-40); 
                
                drawChart(downsampled);
                updateChartHeader(prices[prices.length-1]);
                
            } catch (e) {
                console.warn("Chart Error:", e);
                drawChart([100, 102, 105, 103, 108, 112, 110, 115, 118, 114, 120]);
            }
        };

        function updateChartHeader(price) {
            const el = document.getElementById('chart-price');
            el.innerText = '$' + price.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 6});
        }

        function drawChart(data) {
            const svg = document.getElementById('main-chart');
            if(!svg) return;
            
            const rect = svg.getBoundingClientRect();
            const width = rect.width || 350;
            const height = rect.height || 200;
            svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
            
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = max - min || 1; 

            const points = data.map((val, i) => {
                const x = (i / (data.length - 1)) * width;
                const y = height - ((val - min) / range) * (height * 0.7) - (height * 0.15);
                return {x, y};
            });

            const pathD = getSplinePath(points);
            document.getElementById('chart-path-line').setAttribute('d', pathD);
            document.getElementById('chart-path-area').setAttribute('d', `${pathD} L${width},${height} L0,${height} Z`);
            
            const last = points[points.length-1];
            const dot = document.getElementById('chart-dot');
            dot.setAttribute('cx', last.x);
            dot.setAttribute('cy', last.y);
        }

        function getSplinePath(points) {
            if (points.length === 0) return "";
            if (points.length === 1) return `M${points[0].x},${points[0].y}`;
            let d = `M${points[0].x},${points[0].y}`;
            for (let i = 0; i < points.length - 1; i++) {
                const p0 = points[Math.max(i - 1, 0)];
                const p1 = points[i];
                const p2 = points[i + 1];
                const p3 = points[Math.min(i + 2, points.length - 1)];
                const cp1x = p1.x + (p2.x - p0.x) / 6;
                const cp1y = p1.y + (p2.y - p0.y) / 6;
                const cp2x = p2.x - (p3.x - p1.x) / 6;
                const cp2y = p2.y - (p3.y - p1.y) / 6;
                d += ` C${cp1x},${cp1y} ${cp2x},${cp2y} ${p2.x},${p2.y}`;
            }
            return d;
        }

        // --- UI UTILS ---
        function updateBalanceUI() {
            let total = 0;
            for (const [key, qty] of Object.entries(window.appState.balances)) {
                total += qty * (window.appState.rates[key] || 0);
            }
            document.getElementById('total-balance').innerText = '$' + total.toLocaleString(undefined, {minimumFractionDigits: 2});
        }

        function renderAssetList() {
            const container = document.getElementById('assets-list');
            container.innerHTML = '';
            Object.keys(window.appState.assets).forEach(key => {
                const asset = window.appState.assets[key];
                const bal = window.appState.balances[key] || 0;
                const price = window.appState.rates[key] || 0;
                const val = bal * price;
                const isSelected = window.appState.currentAsset === key;
                
                const div = document.createElement('div');
                div.className = `p-4 rounded-xl flex items-center justify-between border transition-all cursor-pointer mb-2 ${isSelected ? 'bg-zinc-800 border-[#ccff00] shadow-[0_0_10px_rgba(204,255,0,0.1)]' : 'bg-zinc-900/50 border-zinc-800/50 hover:bg-zinc-800'}`;
                div.onclick = () => { window.initChart(key); renderAssetList(); };
                div.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="cty-logo-container"><img src="${asset.icon}" class="cty-logo-img"></div>
                        <div>
                            <p class="font-bold text-lg leading-tight flex items-center gap-2 text-white">
                                ${asset.name}
                                ${key === 'CTY' ? '<span class="text-[10px] bg-[#ccff00]/20 text-[#ccff00] px-1.5 py-0.5 rounded border border-[#ccff00]/30">LOCKED</span>' : ''}
                            </p>
                            <p class="text-xs text-zinc-500 font-mono">$${price.toLocaleString(undefined, {maximumFractionDigits: 6})}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-lg text-white">$${val.toLocaleString(undefined, {maximumFractionDigits: 2})}</p>
                        <p class="text-xs text-zinc-500 font-mono">${bal.toFixed(4)} ${key}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function renderHistory() {
            const list = document.getElementById('history-list');
            list.innerHTML = window.appState.transactions.length ? '' : '<div class="text-center text-zinc-600 py-8">No transactions found</div>';
            window.appState.transactions.forEach(tx => {
                list.innerHTML += `
                    <div class="bg-zinc-900/50 p-4 rounded-xl flex items-center justify-between border border-zinc-800/30 mb-2">
                        <div class="flex items-center gap-3">
                            <div class="p-2 rounded-full ${tx.type === 'deposit' ? 'bg-[#ccff00]/20 text-[#ccff00]' : 'bg-red-500/20 text-red-500'}">
                                <i data-lucide="${tx.type === 'deposit' ? 'arrow-down-left' : 'arrow-up-right'}"></i>
                            </div>
                            <div><p class="font-bold capitalize text-sm text-white">${tx.type}</p><p class="text-[10px] text-zinc-500">Confirmed</p></div>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-sm ${tx.type === 'deposit' ? 'text-[#ccff00]' : 'text-white'}">
                                ${tx.type === 'deposit' ? '+' : '-'}${tx.amount || tx.inAmount} ${tx.asset || tx.from}
                            </p>
                        </div>
                    </div>
                `;
            });
            if(window.lucide) lucide.createIcons();
        }

        // --- NAVIGATION ---
        window.switchTab = (tab) => {
            ['home','swap','history','claim'].forEach(t => document.getElementById('view-'+t).classList.add('hidden'));
            document.getElementById('view-'+tab).classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(b => {
                b.classList.remove('text-[#ccff00]');
                b.classList.add('text-zinc-600');
            });
            const btn = document.getElementById('nav-'+tab);
            if(btn) {
                btn.classList.remove('text-zinc-600');
                btn.classList.add('text-[#ccff00]');
            }
            if(tab==='home') window.initChart(window.appState.currentAsset);
        }

        window.openWhitePaper = () => document.getElementById('whitepaper-modal').classList.remove('hidden');
        window.closeWhitePaper = () => document.getElementById('whitepaper-modal').classList.add('hidden');
        window.closeModal = () => document.getElementById('feature-modal').classList.add('hidden');
        window.showFeatureModal = (t) => {
            document.getElementById('modal-title').innerText = t;
            document.getElementById('feature-modal').classList.remove('hidden');
        }
        window.toggleAuthType = () => {
            const isLogin = document.getElementById('auth-submit-btn').innerText === 'LOGIN';
            document.getElementById('auth-submit-btn').innerText = isLogin ? 'SIGN UP' : 'LOGIN';
            document.getElementById('auth-toggle-link').innerText = isLogin ? 'Login' : 'Create ID';
            document.getElementById('auth-head').innerText = isLogin ? 'Create Web4 ID' : 'Web4 Connect';
        }

        function showScreen(name) {
            document.querySelectorAll('.screen').forEach(s => { s.style.display='none'; s.classList.remove('active'); });
            const s = document.getElementById(name+'-screen');
            if(name === 'auth') s.style.display = 'flex'; 
            else s.style.display = 'flex'; // Use flex for layout
            
            setTimeout(()=>s.classList.add('active'),10);
            if(name==='app') {
                if(window.lucide) lucide.createIcons();
                initChart('BTC');
                window.dispatchEvent(new Event('resize'));
                setInterval(() => {
                    const d = new Date();
                    document.getElementById('countdown').innerText = `${90 - d.getDay()}d : ${24 - d.getHours()}h : ${60 - d.getMinutes()}m`;
                }, 1000);
            }
        }

        // --- SAFE INIT ---
        window.onload = () => {
            // Safety: Attempt icons immediately
            if(window.lucide) lucide.createIcons();

            // Safety: Force intro close after 3s if no auth event fires (fallback)
            setTimeout(() => {
                if(!auth.currentUser) {
                    document.getElementById('intro-screen').style.display='none';
                    showScreen('auth');
                }
            }, 3000);
            
            window.addEventListener('resize', () => {
                if(window.appState.currentAsset) window.initChart(window.appState.currentAsset);
            });
        }
    </script>
</head>
<body>
    
    <!-- INTRO -->
    <div id="intro-screen" class="fixed inset-0 z-50 bg-black flex flex-col items-center justify-center transition-opacity">
        <div class="relative animate-bounce-slight">
            <div class="absolute inset-0 bg-[#ccff00] blur-xl opacity-20 rounded-full"></div>
            <i data-lucide="shield" class="w-20 h-20 text-[#ccff00] relative z-10"></i>
        </div>
        <div class="mt-8 text-center">
            <h1 class="text-3xl font-bold tracking-widest font-mono">CRYPTINITY</h1>
            <p class="text-[#ccff00] text-sm animate-pulse tracking-[0.3em] uppercase mt-2">Entering.. Safe Zone</p>
        </div>
    </div>

    <!-- AUTH SCREEN -->
    <div id="auth-screen" class="screen login-bg z-40 items-center justify-center p-6">
        <div class="w-full max-w-sm glass-panel p-8 rounded-3xl text-center relative z-10 border border-[#ccff00]/30 shadow-[0_0_40px_rgba(204,255,0,0.1)]">
            <div class="w-20 h-20 bg-black rounded-full flex items-center justify-center mx-auto mb-6 border-2 border-[#ccff00] shadow-[0_0_15px_#ccff00]">
                <i data-lucide="globe" class="w-10 h-10 text-[#ccff00]"></i>
            </div>
            <h2 id="auth-head" class="text-3xl font-bold mb-2 text-white tracking-tight">Web4 Connect</h2>
            <p class="text-zinc-400 text-sm mb-8">Secure Neural Interface</p>
            <form onsubmit="handleEmailAuth(event)" class="space-y-4 text-left">
                <div>
                    <label class="text-xs text-[#ccff00] font-bold ml-1 mb-1 block">USER ID</label>
                    <input type="email" id="email" class="w-full bg-black/50 border border-zinc-700 rounded-xl p-3 text-white outline-none focus:border-[#ccff00] transition-all" placeholder="user@web4.net">
                </div>
                <div>
                    <label class="text-xs text-[#ccff00] font-bold ml-1 mb-1 block">PASSKEY</label>
                    <input type="password" id="password" class="w-full bg-black/50 border border-zinc-700 rounded-xl p-3 text-white outline-none focus:border-[#ccff00] transition-all" placeholder="••••••••">
                </div>
                <button type="submit" id="auth-submit-btn" class="w-full bg-[#ccff00] text-black font-bold py-3.5 rounded-xl hover:shadow-[0_0_20px_#ccff00] transition-all transform hover:scale-[1.02] mt-2">LOGIN</button>
            </form>
            <div class="flex items-center gap-3 my-6">
                <div class="h-px bg-zinc-800 flex-1"></div><span class="text-xs text-zinc-500 font-mono">OR ACCESS VIA</span><div class="h-px bg-zinc-800 flex-1"></div>
            </div>
            <button onclick="handleGoogleAuth()" class="w-full bg-white text-black font-bold py-3 rounded-xl hover:bg-zinc-200 transition-colors flex items-center justify-center gap-2 mb-3">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-5 h-5"> Continue with Google
            </button>
            <button onclick="skipAuth()" class="w-full border border-zinc-700 text-zinc-300 font-bold py-3 rounded-xl hover:bg-zinc-800 hover:text-white transition-colors flex items-center justify-center gap-2">
                <i data-lucide="ghost" class="w-4 h-4"></i> Guest Protocol
            </button>
            <p class="text-xs text-zinc-500 mt-6">No account? <span id="auth-toggle-link" class="text-[#ccff00] cursor-pointer font-bold hover:underline" onclick="toggleAuthType()">Create ID</span></p>
        </div>
    </div>

    <!-- APP DASHBOARD (RESPONSIVE) -->
    <div id="app-screen" class="screen">
        <div class="w-full h-full flex flex-col">
            
            <!-- HEADER -->
            <div class="w-full px-6 py-4 flex justify-between items-center bg-black/90 backdrop-blur-md sticky top-0 z-30 border-b border-zinc-800">
                <div class="flex items-center gap-2">
                    <i data-lucide="shield" class="w-6 h-6 text-[#ccff00]"></i>
                    <span class="font-bold tracking-wider text-lg">CRYPTINITY</span>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="openWhitePaper()" class="text-zinc-400 hover:text-[#ccff00] transition-colors hidden md:block text-sm font-bold">White Paper</button>
                    <button onclick="openWhitePaper()" class="p-2 bg-zinc-900 rounded-full border border-zinc-800 hover:border-[#ccff00] transition-colors md:hidden">
                        <i data-lucide="file-text" class="w-5 h-5 text-zinc-400"></i>
                    </button>
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-[#ccff00] to-green-600"></div>
                </div>
            </div>

            <!-- DASHBOARD CONTENT (GRID LAYOUT) -->
            <div id="dashboard-grid">
                
                <!-- HOME VIEW -->
                <div id="view-home" class="col-span-1 lg:col-span-2 flex flex-col gap-6 w-full h-full">
                    
                    <!-- Left/Top Section -->
                    <div class="flex flex-col gap-6">
                        
                        <!-- Header Stats -->
                        <div class="flex flex-col md:flex-row justify-between items-end gap-4">
                            <div>
                                <p class="text-zinc-500 text-xs uppercase tracking-wider mb-1">Total Balance</p>
                                <h1 id="total-balance" class="text-4xl lg:text-5xl font-bold text-white">$0.00</h1>
                            </div>
                            <div class="inline-flex items-center gap-1 bg-[#ccff00]/10 text-[#ccff00] text-xs px-3 py-1 rounded-full border border-[#ccff00]/20">
                                <i data-lucide="trending-up" class="w-3 h-3"></i> +2.4% Today
                            </div>
                        </div>

                        <!-- PRO CHART -->
                        <div class="glass-chart rounded-3xl p-6 relative overflow-hidden group w-full flex-1 min-h-[300px]" id="main-chart-container">
                            <div class="flex justify-between items-start mb-4">
                                <div class="flex items-center gap-3">
                                    <div class="cty-logo-container" style="width: 32px; height: 32px;">
                                        <img id="chart-icon" src="" class="cty-logo-img">
                                    </div>
                                    <div>
                                        <p id="chart-name" class="text-sm font-bold text-zinc-300">Bitcoin</p>
                                        <p id="chart-price" class="text-xl lg:text-2xl font-mono font-bold leading-none text-white tracking-tight">$0.00</p>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <span class="text-[10px] bg-zinc-800 border border-zinc-700 px-3 py-1 rounded text-zinc-400">24H</span>
                                </div>
                            </div>

                            <!-- SVG Chart -->
                            <div class="w-full h-full relative" style="height: calc(100% - 60px);">
                                <svg id="main-chart" class="w-full h-full" preserveAspectRatio="none">
                                    <defs>
                                        <linearGradient id="gradientArea" x1="0" x2="0" y1="0" y2="1">
                                            <stop offset="0%" stop-color="#ccff00" stop-opacity="0.2"/>
                                            <stop offset="100%" stop-color="#ccff00" stop-opacity="0"/>
                                        </linearGradient>
                                    </defs>
                                    <path id="chart-path-area" class="chart-area" d="" />
                                    <path id="chart-path-line" class="chart-line" d="" />
                                    <circle id="chart-dot" r="6" fill="#000" stroke="#ccff00" stroke-width="3" cx="0" cy="0" />
                                </svg>
                                <div class="absolute inset-0 pointer-events-none flex flex-col justify-between py-2 opacity-10">
                                    <div class="border-t border-white w-full"></div><div class="border-t border-white w-full"></div><div class="border-t border-white w-full"></div><div class="border-t border-white w-full"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="grid grid-cols-4 gap-4">
                            <button onclick="showFeatureModal('Deposit')" class="flex flex-col items-center gap-2 group p-4 bg-zinc-900/50 rounded-2xl hover:bg-zinc-800 transition-all border border-zinc-800/50"><div class="w-10 h-10 rounded-full bg-[#ccff00] flex items-center justify-center text-black shadow-[0_0_15px_rgba(204,255,0,0.3)]"><i data-lucide="arrow-down-left" class="w-5 h-5"></i></div><span class="text-xs font-bold text-zinc-300">Deposit</span></button>
                            <button onclick="showFeatureModal('Withdraw')" class="flex flex-col items-center gap-2 group p-4 bg-zinc-900/50 rounded-2xl hover:bg-zinc-800 transition-all border border-zinc-800/50"><div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-white border border-zinc-700 group-hover:border-[#ccff00] transition-colors"><i data-lucide="arrow-up-right" class="w-5 h-5"></i></div><span class="text-xs font-bold text-zinc-300">Withdraw</span></button>
                            <button onclick="switchTab('swap')" class="flex flex-col items-center gap-2 group p-4 bg-zinc-900/50 rounded-2xl hover:bg-zinc-800 transition-all border border-zinc-800/50"><div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-white border border-zinc-700 group-hover:border-[#ccff00] transition-colors"><i data-lucide="refresh-ccw" class="w-5 h-5"></i></div><span class="text-xs font-bold text-zinc-300">Swap</span></button>
                             <button onclick="switchTab('claim')" class="flex flex-col items-center gap-2 group p-4 bg-zinc-900/50 rounded-2xl hover:bg-zinc-800 transition-all border border-zinc-800/50"><div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-[#ccff00] border border-zinc-700 group-hover:bg-[#ccff00]/10 transition-colors"><i data-lucide="gift" class="w-5 h-5"></i></div><span class="text-xs font-bold text-zinc-300">Claim</span></button>
                        </div>
                    </div>
                </div>

                <!-- Right Side: Assets & Info -->
                <div class="col-span-1 desktop-full-height flex flex-col gap-6">
                    <div class="bg-zinc-900/50 border border-zinc-800 rounded-2xl p-5 flex items-center justify-between backdrop-blur-sm">
                        <div class="flex items-center gap-4">
                            <div class="p-3 bg-[#ccff00]/10 rounded-full"><i data-lucide="clock" class="w-6 h-6 text-[#ccff00]"></i></div>
                            <div><p class="text-[10px] text-zinc-400 uppercase tracking-wider font-bold">Safe Zone Unlock</p><p id="countdown" class="text-white font-mono text-xl font-bold">90d : 00h : 00m</p></div>
                        </div>
                    </div>
                    <div class="flex-1 bg-zinc-900/30 rounded-3xl border border-zinc-800/50 p-6 overflow-hidden flex flex-col">
                        <h3 class="font-bold text-lg mb-4 text-zinc-300">Live Markets</h3>
                        <div id="assets-list" class="space-y-3 overflow-y-auto no-scrollbar flex-1"></div>
                    </div>
                </div>

                <!-- Hidden Views -->
                <div id="view-swap" class="hidden col-span-1 lg:col-span-3 flex flex-col justify-center items-center h-full">
                    <div class="bg-zinc-900 p-8 rounded-3xl border border-zinc-800 w-full max-w-md shadow-2xl">
                        <h2 class="text-2xl font-bold mb-4">Exchange</h2>
                        <div class="bg-black p-4 rounded-xl border border-zinc-800 mb-2 text-left"><p class="text-xs text-zinc-500">From</p><div class="flex justify-between items-center mt-1"><span class="text-2xl font-bold">0.00</span><span class="font-bold">USDT</span></div></div>
                        <div class="flex justify-center -my-3 relative z-10"><div class="bg-[#ccff00] p-2 rounded-full text-black border-4 border-zinc-900"><i data-lucide="arrow-down-up" class="w-5 h-5"></i></div></div>
                        <div class="bg-black p-4 rounded-xl border border-zinc-800 mt-2 text-left"><p class="text-xs text-zinc-500">To</p><div class="flex justify-between items-center mt-1"><span class="text-2xl font-bold">0.00</span><span class="font-bold">CTY</span></div></div>
                        <button class="w-full bg-zinc-800 text-zinc-500 font-bold py-4 rounded-xl mt-6 cursor-not-allowed">Insufficient Balance</button>
                        <button onclick="switchTab('home')" class="mt-4 text-zinc-500 text-xs hover:text-white">Cancel</button>
                    </div>
                </div>

                <div id="view-history" class="hidden col-span-1 lg:col-span-3 w-full h-full p-4">
                    <h2 class="font-bold text-xl mb-4">Transactions</h2>
                    <div id="history-list" class="max-w-2xl mx-auto"></div>
                    <button onclick="switchTab('home')" class="mt-4 text-zinc-500 text-xs hover:text-white block mx-auto">Back to Home</button>
                </div>

                <div id="view-claim" class="hidden col-span-1 lg:col-span-3 w-full h-full flex flex-col">
                    <div class="flex justify-between items-center p-4 bg-zinc-900 border-b border-zinc-800 rounded-t-2xl">
                        <div class="flex items-center gap-2"><i data-lucide="gift" class="w-4 h-4 text-[#ccff00]"></i><span class="text-xs font-bold">Web4 Airdrop</span></div>
                        <button onclick="switchTab('home')" class="text-zinc-500 text-xs hover:text-white">Close</button>
                    </div>
                    <iframe src="https://cryptinity.github.io/Sci-fi-Cryptinity-Web4/" class="w-full h-full flex-1 border-0 bg-zinc-950 rounded-b-2xl" style="min-height: 500px;"></iframe>
                </div>

            </div> 
        </div>
        
        <!-- NAV BAR (Mobile) -->
        <div class="lg:hidden safe-padding-bottom fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-xl border-t border-zinc-900 pb-4 pt-4 px-8 flex justify-between items-center z-50">
            <button onclick="switchTab('home')" class="nav-btn text-[#ccff00] flex flex-col items-center gap-1 group" id="nav-home"><i data-lucide="wallet" class="w-6 h-6 group-active:scale-95 transition-transform"></i><span class="text-[10px] font-bold">Wallet</span></button>
            <button onclick="switchTab('swap')" class="nav-btn text-zinc-600 flex flex-col items-center gap-1 group" id="nav-swap"><i data-lucide="arrow-right-left" class="w-6 h-6 group-active:scale-95 transition-transform"></i><span class="text-[10px] font-bold">Swap</span></button>
            <button onclick="switchTab('history')" class="nav-btn text-zinc-600 flex flex-col items-center gap-1 group" id="nav-history"><i data-lucide="history" class="w-6 h-6 group-active:scale-95 transition-transform"></i><span class="text-[10px] font-bold">History</span></button>
            <button onclick="switchTab('claim')" class="nav-btn text-zinc-600 flex flex-col items-center gap-1 group" id="nav-claim"><i data-lucide="gift" class="w-6 h-6 group-active:scale-95 transition-transform"></i><span class="text-[10px] font-bold">Claim</span></button>
        </div>

        <!-- MODALS -->
        <div id="feature-modal" class="hidden fixed inset-0 z-[60] bg-black/80 backdrop-blur-md flex items-center justify-center p-4">
            <div class="bg-zinc-900 w-full max-w-sm rounded-3xl p-8 border border-zinc-800 text-center relative overflow-hidden shadow-2xl">
                <div class="w-16 h-16 bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-6 border border-zinc-700"><i data-lucide="construction" class="w-8 h-8 text-[#ccff00]"></i></div>
                <h3 id="modal-title" class="text-2xl font-bold text-white mb-2">Feature</h3>
                <p class="text-[#ccff00] font-mono tracking-widest text-sm uppercase mb-6">Available Soon</p>
                <button onclick="closeModal()" class="w-full bg-white text-black font-bold py-3 rounded-xl hover:bg-zinc-200">Understood</button>
            </div>
        </div>

        <!-- WHITE PAPER MODAL -->
        <div id="whitepaper-modal" class="hidden fixed inset-0 z-[70] bg-black/95 flex flex-col animate-in slide-in-from-bottom duration-300 md:items-center md:justify-center">
            <div class="w-full h-full md:max-w-2xl md:h-[80vh] md:border md:border-zinc-800 md:rounded-2xl bg-black flex flex-col">
                <div class="safe-padding-top px-6 py-4 bg-zinc-900 border-b border-zinc-800 flex justify-between items-center sticky top-0 z-10 md:rounded-t-2xl">
                    <h2 class="text-lg font-bold">White Paper</h2>
                    <button onclick="closeWhitePaper()" class="bg-black p-2 rounded-full border border-zinc-700 hover:bg-zinc-900"><i data-lucide="x" class="w-5 h-5"></i></button>
                </div>
                <div class="flex-1 overflow-y-auto p-6 whitepaper-content safe-padding-bottom pb-24 md:pb-6">
                    <p class="text-[#ccff00] font-mono text-xs uppercase mb-4 tracking-widest">Version 1.0 | December 2025</p>
                    <h1>THE ARCHITECTURE OF THE SAFE ZONE</h1>
                    <h2>1. ABSTRACT</h2>
                    <p>Welcome to the Safe Zone. The internet is broken. Web2 sold your data; Web3 was too complex. Cryptinity Web4 is the next evolution—a "Sci-Fi Hybrid" ecosystem that unifies Social Interaction, High-Speed Finance, Digital Vaults, and Military-Grade Security into a single mobile application.</p>
                    <p>Cryptinity is not just a platform; it is a Social Finance (SoFi) Protocol powered by the CTY token. By leveraging the Solana blockchain, we have achieved the theoretical limit of transaction speed—making finance faster than the speed of light compared to legacy banking.</p>
                    <h2>2. THE PROBLEM</h2>
                    <p><strong>Social Manipulation:</strong> Social giants use predatory "Algorithms" to control what you see.</p>
                    <p><strong>Financial Friction:</strong> Traditional banks are archaic. "Pending Transactions," hidden fees, and weekend delays are unacceptable.</p>
                    <p><strong>Security Failures:</strong> Centralized platforms are honey pots for hackers. Your data is constantly at risk.</p>
                    <h2>3. THE SOLUTION: THE 4 PILLARS</h2>
                    <p><strong>Pillar I: SOCIAL</strong> - The Zero-Algorithm Protocol. No manipulation. 100% organic reach.</p>
                    <p><strong>Pillar II: FINANCE</strong> - Hyper-Velocity Transactions. Utilizing Solana’s Proof-of-History (PoH) mechanism.</p>
                    <p><strong>Pillar III: THE VAULT</strong> - The Neo-Bank. Self-Custody. You hold your keys.</p>
                    <p><strong>Pillar IV: SECURITY</strong> - The "Safe Zone" Priority. Imunify 360 Integration.</p>
                    <h2>4. THE TOKEN: CTY</h2>
                    <p>Token Name: Cryptinity Web4<br>Ticker: CTY<br>Network: Solana (SPL Token-2022 Standard)<br>Total Supply: 1,000,000,000 CTY</p>
                    <h2>5. ROADMAP</h2>
                    <p><strong>Phase 1: The Awakening (Current)</strong><br>Deployment of CTY Token on Solana Devnet. Launch of White Paper.</p>
                    <p><strong>Phase 2: The Architecture</strong><br>Beta Launch of the "Zero Algorithm" Social App. Integration of "The Vault" Wallet.</p>
                    <p><strong>Phase 3: The Safe Zone</strong><br>Global Marketing Campaign. Listing on Major Exchanges. Full Web4 AI Integration.</p>
                    <h2>6. CONCLUSION</h2>
                    <p>The era of slow banking and manipulated social feeds is over. We are building a sanctuary for your digital life.</p>
                    <p><strong>Cryptinity Web4. Social. Finance. Vault. Security. Welcome to the Safe Zone.</strong></p>
                </div>
            </div>
        </div>

    </div>
</body>
</html>
